<!DOCTYPE html>
<html>
<head>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>

<script src="http://maps.googleapis.com/maps/api/js?key=<%=ENV["GOOGLE_API"]%>&libraries=places,geometry&sensor=false">
</script>

</head>

<body>
<form class="user-input">
<input id="food" type="text" placeholder="Enter food here" />
<input type="submit" />
</form>
<div id="googleMap" style="width:1000px;height:600px;"></div>

<script>

// $.get('/address', {}, function (json) {
//   console.log('json:', json);
// });

// $.ajax({
// type: "GET",
//     url: "address",
//     data: "{}",
//     dataType: "json",

//     success: function(data) {
//         alert('success')
//     },
//     error: function(xhr, status, error) {
//   var err = JSON.parse(xhr.responseText);
//   alert(err.Message);
// }

// });

var initialize = function () {
// submit can only be used on a forum
  $('.user-input').on('submit', function (e) {
    e.preventDefault();
    var newItemName = $("#food", this).val();
    console.log(newItemName)
    // ...
    var geocoder= new google.maps.Geocoder();
    var lat = '';
    var lng = '';
    var address = newItemName;
    geocoder.geocode( { 'address': address}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        lat = results[0].geometry.location.lat();
        lng = results[0].geometry.location.lng();
        console.log(lat,lng)
        var mapProp = {
          center: new google.maps.LatLng(lat,lng), //austin
          zoom: 15,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        var map = new google.maps.Map(document.getElementById("googleMap"), mapProp);
        // ajax request
      }
    });
  });



};

google.maps.event.addDomListener(window, 'load', initialize);
</script>


</body>
</html>
